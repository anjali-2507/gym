"use strict";(()=>{var e={};e.id=54,e.ids=[54],e.modules={38013:e=>{e.exports=require("mongodb")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84113:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>v,patchFetch:()=>D,requestAsyncStorage:()=>y,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>M});var a={};n.r(a),n.d(a,{GET:()=>g,dynamic:()=>p});var o=n(49303),r=n(88716),s=n(60670),i=n(87070),c=n(38013);let u=process.env.MONGODB_URI||"",l={serverSelectionTimeoutMS:5e3,connectTimeoutMS:1e5};async function m(){console.log("Attempting to connect to MongoDB...");let e=new c.MongoClient(u,l);return await e.connect(),console.log("Successfully connected to MongoDB"),e}let d=(e,t)=>{if(!e||!t)return"N/A";let n=new Date(e),a=Math.abs(new Date(t).getTime()-n.getTime());return`${Math.floor(a/36e5)}h ${Math.floor(a%36e5/6e4)}m`},p="force-dynamic";async function g(e){let t=null;try{let e=(t=await m()).db("Gym_Management"),n=(await e.collection("marks").find({}).toArray()).map(e=>{let t=d(e.time,e.statusTime);return{_id:e._id,clientName:e.clientName,clientNumber:e.clientNumber,date:new Date(e.date).toLocaleString(),time:e.time,status:e.status,markDate:new Date(e.markDate).toLocaleString(),statusTime:e.statusTime?new Date(e.statusTime).toLocaleString():null,totalTime:t,__v:e.__v}});return console.log(`Retrieved ${n.length} documents from the database`),i.NextResponse.json({success:!0,message:"Data fetched successfully",data:n},{status:200})}catch(t){console.error("Error in Fetching",t);let e="Error in Fetching";return t instanceof Error&&(e+=": "+t.message),i.NextResponse.json({success:!1,message:e},{status:500})}finally{t&&(await t.close(),console.log("MongoDB connection closed"))}}let h=new o.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/Gym_Management/route",pathname:"/api/Gym_Management",filename:"route",bundlePath:"app/api/Gym_Management/route"},resolvedPagePath:"D:\\Gym-Dashboard-main\\app\\api\\Gym_Management\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:y,staticGenerationAsyncStorage:M,serverHooks:f}=h,v="/api/Gym_Management/route";function D(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:M})}},49303:(e,t,n)=>{e.exports=n(30517)}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),a=t.X(0,[948,70],()=>n(84113));module.exports=a})();